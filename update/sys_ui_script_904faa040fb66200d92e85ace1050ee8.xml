<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_ui_script">
    <sys_ui_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <description/>
        <global>false</global>
        <name>x_44552_menu_das.app_angular_menu</name>
        <script><![CDATA[angular.module("app_angular_menu", ['sn.glideAjax']);
angular.module("app_angular_menu").controller("MenuController", 
	function($scope, GlideAjax){
		var scope = "x_44552_menu_das";
		$scope.loading = true;
		$scope.searchText = "";
		$scope.title = "Menu - Dashboard";
		$scope.subtitle = "Today is a good day to code";
		$scope.tiles = [];
		$scope.path = [{"sys_id": "", "name": "HomePage", "level": 0}];
		$scope.message = "loading data...";
		$scope.parent = null;
		
		$scope.clickTile = function(tile){
			$scope.message = "loading tiles for " + tile.name ;
			getTiles(tile);
		};

		load();
		
		function load(){
			getDefaultApplications();
		}
	
		function getDefaultApplications(){
			$scope.loading = true;
			$scope.parent = parent;
			
			var ga = new GlideAjax("MenuDashboard");
			ga.addParam("sysparm_name", "getDefaultMenus");
			ga.setScope(scope);
			ga.getJSON(function(response){
				if(!response){
					$scope.message = "No response received";
					return ;
				}
				
				if(response.error){
					$scope.message = response.message;
					return ;
				}
				
				$scope.message = response.length + " tiles loaded";
				$scope.tiles = response;
				$scope.loading = false;
			});		
		}
	
		function getTiles(parent){
			$scope.loading = true;
			$scope.parent = parent;
			
			var ga = new GlideAjax("MenuDashboard");
			ga.addParam("sysparm_name", "getTiles");
			
			if(parent){
				ga.addParam("parent", parent.sys_id);
				$scope.path.splice(parent.level, $scope.path.length);
				$scope.path.push(parent);
			}
			
			ga.setScope(scope);
			ga.getJSON(function(response){
				if(!response){
					$scope.message = "No response received";
					return ;
				}
				
				if(response.error){
					$scope.message = response.message;
					return ;
				}
				
				$scope.message = response.length + " tiles loaded";
				$scope.tiles = response;
				$scope.loading = false;
			});		
		}
	}
);]]></script>
        <script_name>app_angular_menu</script_name>
        <sys_class_name>sys_ui_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2016-10-26 15:32:29</sys_created_on>
        <sys_customer_update>true</sys_customer_update>
        <sys_id>904faa040fb66200d92e85ace1050ee8</sys_id>
        <sys_mod_count>72</sys_mod_count>
        <sys_name>x_44552_menu_das.app_angular_menu</sys_name>
        <sys_package display_value="Menu - Dashboard" source="x_44552_menu_das">2d7cee8c0f766200d92e85ace1050ecc</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Menu - Dashboard">2d7cee8c0f766200d92e85ace1050ecc</sys_scope>
        <sys_update_name>sys_ui_script_904faa040fb66200d92e85ace1050ee8</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2016-10-27 17:04:11</sys_updated_on>
        <use_scoped_format>false</use_scoped_format>
    </sys_ui_script>
</record_update>
